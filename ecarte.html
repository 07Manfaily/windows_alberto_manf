import React, { useState, useEffect } from 'react';
import { Calendar, Building2, Users, FileText, Plus, Search, Download, Edit, Eye, Trash2, Home, TrendingUp, Upload, File, FolderOpen, Save, RefreshCw, FileSpreadsheet, FileImage, ChevronLeft, ChevronRight, Filter, ArrowLeft, UserCheck, DollarSign } from 'lucide-react';

const API_BASE_URL = 'http://10.9.100.115:5010/api/automation_ag';

const App = () => {
  const [currentView, setCurrentView] = useState('dashboard');
  const [entreprises, setEntreprises] = useState([]);
  const [ags, setAgs] = useState([]);
  const [selectedAg, setSelectedAg] = useState(null);
  const [selectedSgi, setSelectedSgi] = useState(null);
  const [agActiveTab, setAgActiveTab] = useState('participants'); // participants, actionnaires, fichiers
  const [searchTerm, setSearchTerm] = useState('');
  const [showModal, setShowModal] = useState(false);
  const [modalType, setModalType] = useState('');
  const [loading, setLoading] = useState(false);

  // États pour les données selon les APIs
  const [participants, setParticipants] = useState([]); // list_users_ag/{code_ag}
  const [actionnaires, setActionnaires] = useState([]); // liste_actionnaires_ag
  const [fichiers, setFichiers] = useState([]); // get_list_file_ag/{ag_id}/files
  const [sgiList, setSgiList] = useState([]); // liste_sgi_ag

  // États pour pagination et filtrage
  const [currentPage, setCurrentPage] = useState(1);
  const [itemsPerPage] = useState(20);
  const [filterType, setFilterType] = useState('all');

  // Simulated data loading selon structure API
  useEffect(() => {
    loadInitialData();
  }, []);

  const loadInitialData = async () => {
    // Simulation des appels API
    
    // GET /liste_entreprises
    setEntreprises([
      { id: 1, nom_entreprise: "TechCorp SA", entreprise_id: 1, created_at: "2024-01-15" },
      { id: 2, nom_entreprise: "InnoVest Partners", entreprise_id: 2, created_at: "2024-02-20" }
    ]);
    
    // GET /list_ags
    setAgs([
      { 
        id: 1, 
        code_ag: "AG2026-001", 
        date_ag: "2026-03-15", 
        entreprise_id: 1,
        nom_entreprise: "TechCorp SA"
      },
      { 
        id: 2, 
        code_ag: "AG2026-002", 
        date_ag: "2026-04-20", 
        entreprise_id: 1,
        nom_entreprise: "TechCorp SA"
      }
    ]);

    // GET /liste_sgi_ag
    setSgiList([
      {
        id: 1,
        nom_sgi: "SGI Alpha Investments",
        sgi_id: "SGI001",
        status: "active"
      },
      {
        id: 2,
        nom_sgi: "SGI Beta Finance",
        sgi_id: "SGI002", 
        status: "active"
      },
      {
        id: 3,
        nom_sgi: "SGI Gamma Capital",
        sgi_id: "SGI003",
        status: "active"
      }
    ]);
  };

  // Fonction pour charger les données d'une AG selon les APIs
  const loadAgData = async (ag) => {
    setLoading(true);
    setSelectedAg(ag);
    
    try {
      // API: GET /list_users_ag/{code_ag} - Participants regroupés par SGI
      setTimeout(() => {
        setParticipants([
          {
            nom_sgi: "SGI Alpha Investments",
            sgi_id: "SGI001",
            participants: [
              { nom_client: "Dupont Jean", user_id: 1, statut_presence: "present" },
              { nom_client: "Martin Sophie", user_id: 2, statut_presence: "present" },
              { nom_client: "Bernard Pierre", user_id: 3, statut_presence: "absent" },
              { nom_client: "Petit Marie", user_id: 6, statut_presence: "present" }
            ]
          },
          {
            nom_sgi: "SGI Beta Finance", 
            sgi_id: "SGI002",
            participants: [
              { nom_client: "Dubois Marie", user_id: 4, statut_presence: "present" },
              { nom_client: "Laurent Thomas", user_id: 5, statut_presence: "present" },
              { nom_client: "Moreau Claire", user_id: 7, statut_presence: "present" }
            ]
          },
          {
            nom_sgi: "SGI Gamma Capital",
            sgi_id: "SGI003", 
            participants: [
              { nom_client: "Simon Lucas", user_id: 8, statut_presence: "present" },
              { nom_client: "Roux Emma", user_id: 9, statut_presence: "absent" }
            ]
          }
        ]);

        // API: GET /liste_actionnaires_ag - Actionnaires avec détails
        setActionnaires([
          {
            nom_sgi: "SGI Alpha Investments",
            sgi_id: "SGI001", 
            actionnaires: [
              { nom_client: "Dupont Jean", user_id: 1, nombre_actions: 1500, valeur_actions: 45000 },
              { nom_client: "Martin Sophie", user_id: 2, nombre_actions: 2300, valeur_actions: 69000 },
              { nom_client: "Bernard Pierre", user_id: 3, nombre_actions: 1800, valeur_actions: 54000 }
            ],
            total_actions: 5600,
            total_valeur: 168000
          },
          {
            nom_sgi: "SGI Beta Finance",
            sgi_id: "SGI002",
            actionnaires: [
              { nom_client: "Dubois Marie", user_id: 4, nombre_actions: 3200, valeur_actions: 96000 },
              { nom_client: "Laurent Thomas", user_id: 5, nombre_actions: 2700, valeur_actions: 81000 }
            ],
            total_actions: 5900,
            total_valeur: 177000
          },
          {
            nom_sgi: "SGI Gamma Capital", 
            sgi_id: "SGI003",
            actionnaires: [
              { nom_client: "Simon Lucas", user_id: 8, nombre_actions: 1900, valeur_actions: 57000 },
              { nom_client: "Roux Emma", user_id: 9, nombre_actions: 2100, valeur_actions: 63000 }
            ],
            total_actions: 4000,
            total_valeur: 120000
          }
        ]);

        // API: GET /get_list_file_ag/{ag_id}/files - Fichiers de l'AG
        const mockFiles = [];
        for (let i = 1; i <= 25; i++) {
          mockFiles.push({
            fichier_id: i,
            nom_fichier: `fichier_ag_${ag.id}_${i.toString().padStart(3, '0')}.${['xlsx', 'csv', 'pdf'][Math.floor(Math.random() * 3)]}`,
            type_fichier: ['liste_actionnaires', 'rapport_presence', 'proces_verbal', 'convocation'][Math.floor(Math.random() * 4)],
            taille: `${(Math.random() * 5 + 0.1).toFixed(1)} MB`,
            date_upload: new Date(2026, 0, Math.floor(Math.random() * 30) + 1).toISOString(),
            statut: Math.random() > 0.2 ? "processed" : "processing",
            uploader_name: "Admin User"
          });
        }
        setFichiers(mockFiles);
        
        setLoading(false);
      }, 1000);

    } catch (error) {
      console.error('Erreur lors du chargement des données AG:', error);
      setLoading(false);
    }
  };

  const openModal = (type) => {
    setModalType(type);
    setShowModal(true);
  };

  const closeModal = () => {
    setShowModal(false);
    setModalType('');
  };

  // Navigation Component
  const Navigation = () => (
    <div style={{
      background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
      padding: '20px 40px',
      display: 'flex',
      justifyContent: 'space-between',
      alignItems: 'center',
      boxShadow: '0 4px 6px rgba(0,0,0,0.1)'
    }}>
      <div style={{ display: 'flex', alignItems: 'center', gap: '15px' }}>
        <Calendar size={32} color="white" />
        <h1 style={{ color: 'white', margin: 0, fontSize: '24px', fontWeight: 'bold' }}>
          AG Online Pro
        </h1>
      </div>
      <div style={{ display: 'flex', gap: '20px' }}>
        {[
          { id: 'dashboard', icon: Home, label: 'Dashboard' },
          { id: 'entreprises', icon: Building2, label: 'Entreprises' },
          { id: 'ags', icon: Calendar, label: 'Assemblées' },
          { id: 'sgi', icon: TrendingUp, label: 'SGI' },
          { id: 'rapports', icon: FileText, label: 'Rapports' }
        ].map(item => (
          <button
            key={item.id}
            onClick={() => {
              setCurrentView(item.id);
              setSelectedAg(null);
              setSelectedSgi(null);
            }}
            style={{
              background: currentView === item.id ? 'rgba(255,255,255,0.3)' : 'transparent',
              color: 'white',
              border: 'none',
              padding: '10px 20px',
              borderRadius: '8px',
              cursor: 'pointer',
              display: 'flex',
              alignItems: 'center',
              gap: '8px',
              fontSize: '14px',
              fontWeight: '500',
              transition: 'all 0.3s ease'
            }}
            onMouseEnter={(e) => e.target.style.background = 'rgba(255,255,255,0.2)'}
            onMouseLeave={(e) => e.target.style.background = currentView === item.id ? 'rgba(255,255,255,0.3)' : 'transparent'}
          >
            <item.icon size={18} />
            {item.label}
          </button>
        ))}
      </div>
    </div>
  );

  // Breadcrumb Component  
  const Breadcrumb = () => {
    if (!selectedAg && !selectedSgi) return null;

    return (
      <div style={{
        background: 'white',
        padding: '15px 40px',
        display: 'flex',
        alignItems: 'center',
        gap: '15px',
        borderBottom: '1px solid #e5e7eb',
        fontSize: '14px'
      }}>
        <button
          onClick={() => {
            if (selectedSgi) {
              setSelectedSgi(null);
            } else if (selectedAg) {
              setSelectedAg(null);
            }
          }}
          style={{
            background: '#f3f4f6',
            color: '#374151',
            border: 'none',
            padding: '8px 12px',
            borderRadius: '6px',
            cursor: 'pointer',
            display: 'flex',
            alignItems: 'center',
            gap: '6px',
            fontSize: '14px'
          }}
        >
          <ArrowLeft size={16} />
          Retour
        </button>
        
        <div style={{ display: 'flex', alignItems: 'center', gap: '10px', color: '#6b7280' }}>
          <Calendar size={16} />
          <span>Assemblées</span>
          {selectedAg && (
            <>
              <span>›</span>
              <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
                <Calendar size={16} />
                <span style={{ color: '#1a202c', fontWeight: '500' }}>{selectedAg.code_ag}</span>
              </div>
            </>
          )}
          {selectedSgi && (
            <>
              <span>›</span>
              <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
                <TrendingUp size={16} />
                <span style={{ color: '#1a202c', fontWeight: '500' }}>{selectedSgi.nom_sgi}</span>
              </div>
            </>
          )}
        </div>
      </div>
    );
  };

  // Dashboard Component
  const Dashboard = () => (
    <div style={{ padding: '40px' }}>
      <h2 style={{ fontSize: '28px', marginBottom: '30px', color: '#1a202c' }}>
        Tableau de Bord
      </h2>
      
      <div style={{ 
        display: 'grid', 
        gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))', 
        gap: '20px',
        marginBottom: '40px'
      }}>
        {[
          { icon: Building2, label: 'Entreprises', value: entreprises.length, color: '#667eea', bg: '#e0e7ff' },
          { icon: Calendar, label: 'AG Planifiées', value: ags.length, color: '#f59e0b', bg: '#fef3c7' },
          { icon: TrendingUp, label: 'SGI Actifs', value: sgiList.length, color: '#10b981', bg: '#d1fae5' },
          { icon: Users, label: 'Total Participants', value: '245', color: '#ef4444', bg: '#fee2e2' }
        ].map((stat, index) => (
          <div key={index} style={{
            background: 'white',
            padding: '25px',
            borderRadius: '12px',
            boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
            display: 'flex',
            alignItems: 'center',
            gap: '20px',
            transition: 'transform 0.3s ease',
            cursor: 'pointer'
          }}
          onMouseEnter={(e) => e.currentTarget.style.transform = 'translateY(-5px)'}
          onMouseLeave={(e) => e.currentTarget.style.transform = 'translateY(0)'}
          >
            <div style={{
              background: stat.bg,
              padding: '15px',
              borderRadius: '10px'
            }}>
              <stat.icon size={28} color={stat.color} />
            </div>
            <div>
              <div style={{ fontSize: '14px', color: '#6b7280', marginBottom: '5px' }}>
                {stat.label}
              </div>
              <div style={{ fontSize: '28px', fontWeight: 'bold', color: '#1a202c' }}>
                {stat.value}
              </div>
            </div>
          </div>
        ))}
      </div>

      <div style={{ 
        background: 'white', 
        padding: '30px', 
        borderRadius: '12px',
        boxShadow: '0 2px 8px rgba(0,0,0,0.1)'
      }}>
        <h3 style={{ fontSize: '20px', marginBottom: '20px', color: '#1a202c' }}>
          Prochaines Assemblées Générales
        </h3>
        <div style={{ display: 'flex', flexDirection: 'column', gap: '15px' }}>
          {ags.slice(0, 5).map(ag => (
            <div key={ag.id} style={{
              padding: '20px',
              background: '#f9fafb',
              borderRadius: '8px',
              display: 'flex',
              justifyContent: 'space-between',
              alignItems: 'center'
            }}>
              <div>
                <div style={{ fontWeight: 'bold', fontSize: '16px', color: '#1a202c', marginBottom: '5px' }}>
                  {ag.code_ag}
                </div>
                <div style={{ fontSize: '14px', color: '#6b7280' }}>
                  {ag.nom_entreprise} • {new Date(ag.date_ag).toLocaleDateString('fr-FR')}
                </div>
              </div>
              <button 
                onClick={() => {
                  setCurrentView('ags');
                  loadAgData(ag);
                }}
                style={{
                  background: '#667eea',
                  color: 'white',
                  border: 'none',
                  padding: '10px 20px',
                  borderRadius: '6px',
                  cursor: 'pointer',
                  fontSize: '14px'
                }}
              >
                Voir détails
              </button>
            </div>
          ))}
        </div>
      </div>
    </div>
  );

  // Vue détaillée SGI (participants + actionnaires de cette SGI)
  const SGIDetailView = () => {
    const sgiParticipants = participants.find(p => p.sgi_id === selectedSgi.sgi_id)?.participants || [];
    const sgiActionnaires = actionnaires.find(a => a.sgi_id === selectedSgi.sgi_id) || { actionnaires: [], total_actions: 0, total_valeur: 0 };

    return (
      <div style={{ padding: '40px' }}>
        <Breadcrumb />
        
        {/* Header SGI */}
        <div style={{
          background: 'white',
          padding: '30px',
          borderRadius: '12px',
          boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
          marginBottom: '30px'
        }}>
          <div style={{
            background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
            padding: '25px',
            borderRadius: '12px',
            marginBottom: '25px',
            color: 'white'
          }}>
            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
              <div>
                <h2 style={{ fontSize: '28px', margin: 0, marginBottom: '10px' }}>
                  {selectedSgi.nom_sgi}
                </h2>
                <div style={{ opacity: 0.9, fontSize: '14px' }}>
                  ID: {selectedSgi.sgi_id} • AG: {selectedAg.code_ag}
                </div>
              </div>
            </div>
          </div>

          <div style={{
            display: 'grid',
            gridTemplateColumns: 'repeat(4, 1fr)',
            gap: '20px'
          }}>
            <div style={{ background: '#f0f9ff', padding: '20px', borderRadius: '8px', textAlign: 'center' }}>
              <div style={{ fontSize: '24px', fontWeight: 'bold', color: '#1d4ed8' }}>
                {sgiParticipants.length}
              </div>
              <div style={{ fontSize: '14px', color: '#2563eb' }}>Participants</div>
            </div>
            <div style={{ background: '#f0fdf4', padding: '20px', borderRadius: '8px', textAlign: 'center' }}>
              <div style={{ fontSize: '24px', fontWeight: 'bold', color: '#166534' }}>
                {sgiParticipants.filter(p => p.statut_presence === 'present').length}
              </div>
              <div style={{ fontSize: '14px', color: '#16a34a' }}>Présents</div>
            </div>
            <div style={{ background: '#fef3c7', padding: '20px', borderRadius: '8px', textAlign: 'center' }}>
              <div style={{ fontSize: '24px', fontWeight: 'bold', color: '#d97706' }}>
                {sgiActionnaires.total_actions?.toLocaleString() || 0}
              </div>
              <div style={{ fontSize: '14px', color: '#f59e0b' }}>Actions</div>
            </div>
            <div style={{ background: '#f3e8ff', padding: '20px', borderRadius: '8px', textAlign: 'center' }}>
              <div style={{ fontSize: '24px', fontWeight: 'bold', color: '#7c3aed' }}>
                {(sgiActionnaires.total_valeur / 1000)?.toFixed(0) || 0}K€
              </div>
              <div style={{ fontSize: '14px', color: '#8b5cf6' }}>Valeur</div>
            </div>
          </div>
        </div>

        {/* Tabs Participants / Actionnaires */}
        <div style={{
          background: 'white',
          borderRadius: '12px',
          boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
          overflow: 'hidden'
        }}>
          <div style={{ display: 'flex', borderBottom: '1px solid #e5e7eb' }}>
            {[
              { id: 'participants', label: 'Participants', icon: UserCheck, count: sgiParticipants.length },
              { id: 'actionnaires', label: 'Actionnaires', icon: DollarSign, count: sgiActionnaires.actionnaires.length }
            ].map(tab => (
              <button
                key={tab.id}
                onClick={() => setAgActiveTab(tab.id)}
                style={{
                  flex: 1,
                  padding: '20px',
                  background: agActiveTab === tab.id ? '#f9fafb' : 'transparent',
                  border: 'none',
                  cursor: 'pointer',
                  display: 'flex',
                  alignItems: 'center',
                  justifyContent: 'center',
                  gap: '10px',
                  fontSize: '16px',
                  fontWeight: '500',
                  color: agActiveTab === tab.id ? '#667eea' : '#6b7280',
                  borderBottom: agActiveTab === tab.id ? '3px solid #667eea' : '3px solid transparent',
                  transition: 'all 0.3s ease'
                }}
              >
                <tab.icon size={20} />
                {tab.label}
                <div style={{
                  background: agActiveTab === tab.id ? '#667eea' : '#e5e7eb',
                  color: agActiveTab === tab.id ? 'white' : '#6b7280',
                  padding: '4px 10px',
                  borderRadius: '12px',
                  fontSize: '12px',
                  fontWeight: 'bold'
                }}>
                  {tab.count}
                </div>
              </button>
            ))}
          </div>

          <div style={{ padding: '30px' }}>
            {agActiveTab === 'participants' ? (
              <div>
                <h3 style={{ fontSize: '20px', marginBottom: '20px', color: '#1a202c' }}>
                  Participants de {selectedSgi.nom_sgi}
                </h3>
                
                <div style={{ 
                  display: 'grid',
                  gridTemplateColumns: 'repeat(auto-fill, minmax(300px, 1fr))',
                  gap: '15px'
                }}>
                  {sgiParticipants.map((participant, index) => (
                    <div key={index} style={{
                      background: '#fafafa',
                      borderRadius: '12px',
                      padding: '20px',
                      display: 'flex',
                      alignItems: 'center',
                      justifyContent: 'space-between',
                      transition: 'all 0.3s ease',
                      border: '2px solid transparent'
                    }}
                    onMouseEnter={(e) => {
                      e.currentTarget.style.background = '#f0f9ff';
                      e.currentTarget.style.borderColor = '#667eea';
                    }}
                    onMouseLeave={(e) => {
                      e.currentTarget.style.background = '#fafafa';
                      e.currentTarget.style.borderColor = 'transparent';
                    }}
                    >
                      <div style={{ display: 'flex', alignItems: 'center', gap: '15px' }}>
                        <div style={{
                          width: '50px',
                          height: '50px',
                          borderRadius: '50%',
                          background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                          display: 'flex',
                          alignItems: 'center',
                          justifyContent: 'center',
                          color: 'white',
                          fontWeight: 'bold',
                          fontSize: '16px'
                        }}>
                          {participant.nom_client.split(' ').map(n => n.charAt(0)).join('')}
                        </div>
                        <div>
                          <div style={{ fontWeight: '600', color: '#1a202c', fontSize: '16px' }}>
                            {participant.nom_client}
                          </div>
                          <div style={{ fontSize: '13px', color: '#6b7280' }}>
                            ID: {participant.user_id}
                          </div>
                        </div>
                      </div>
                      
                      <div style={{
                        background: participant.statut_presence === 'present' ? '#d1fae5' : '#fee2e2',
                        color: participant.statut_presence === 'present' ? '#065f46' : '#991b1b',
                        padding: '8px 16px',
                        borderRadius: '20px',
                        fontSize: '12px',
                        fontWeight: '600'
                      }}>
                        {participant.statut_presence === 'present' ? 'Présent' : 'Absent'}
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            ) : (
              <div>
                <h3 style={{ fontSize: '20px', marginBottom: '20px', color: '#1a202c' }}>
                  Actionnaires de {selectedSgi.nom_sgi}
                </h3>
                
                <div style={{ 
                  display: 'grid',
                  gridTemplateColumns: 'repeat(auto-fill, minmax(320px, 1fr))',
                  gap: '15px'
                }}>
                  {sgiActionnaires.actionnaires.map((actionnaire, index) => (
                    <div key={index} style={{
                      background: '#fafafa',
                      borderRadius: '12px',
                      padding: '20px',
                      transition: 'all 0.3s ease',
                      border: '2px solid transparent'
                    }}
                    onMouseEnter={(e) => {
                      e.currentTarget.style.background = '#f0fdf4';
                      e.currentTarget.style.borderColor = '#10b981';
                    }}
                    onMouseLeave={(e) => {
                      e.currentTarget.style.background = '#fafafa';
                      e.currentTarget.style.borderColor = 'transparent';
                    }}
                    >
                      <div style={{ display: 'flex', alignItems: 'center', gap: '15px', marginBottom: '15px' }}>
                        <div style={{
                          width: '50px',
                          height: '50px',
                          borderRadius: '50%',
                          background: 'linear-gradient(135deg, #10b981 0%, #059669 100%)',
                          display: 'flex',
                          alignItems: 'center',
                          justifyContent: 'center',
                          color: 'white',
                          fontWeight: 'bold',
                          fontSize: '16px'
                        }}>
                          {actionnaire.nom_client.split(' ').map(n => n.charAt(0)).join('')}
                        </div>
                        <div>
                          <div style={{ fontWeight: '600', color: '#1a202c', fontSize: '16px' }}>
                            {actionnaire.nom_client}
                          </div>
                          <div style={{ fontSize: '13px', color: '#6b7280' }}>
                            ID: {actionnaire.user_id}
                          </div>
                        </div>
                      </div>
                      
                      <div style={{ 
                        display: 'grid',
                        gridTemplateColumns: '1fr 1fr',
                        gap: '10px'
                      }}>
                        <div style={{
                          background: '#e0f2fe',
                          padding: '12px',
                          borderRadius: '8px',
                          textAlign: 'center'
                        }}>
                          <div style={{ fontSize: '18px', fontWeight: 'bold', color: '#0369a1' }}>
                            {actionnaire.nombre_actions.toLocaleString()}
                          </div>
                          <div style={{ fontSize: '12px', color: '#0284c7' }}>Actions</div>
                        </div>
                        <div style={{
                          background: '#f0fdf4',
                          padding: '12px',
                          borderRadius: '8px',
                          textAlign: 'center'
                        }}>
                          <div style={{ fontSize: '18px', fontWeight: 'bold', color: '#166534' }}>
                            {(actionnaire.valeur_actions / 1000).toFixed(0)}K€
                          </div>
                          <div style={{ fontSize: '12px', color: '#16a34a' }}>Valeur</div>
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            )}
          </div>
        </div>
      </div>
    );
  };

  // Vue Assemblées Générales avec structure API correcte  
  const AGsView = () => {
    // Vue détaillée SGI
    if (selectedSgi) {
      return <SGIDetailView />;
    }

    // Vue détaillée AG avec 3 tabs
    if (selectedAg) {
      const renderParticipantsTab = () => (
        <div style={{ padding: '30px' }}>
          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '25px' }}>
            <h3 style={{ fontSize: '20px', color: '#1a202c' }}>
              Participants par SGI
            </h3>
            <div style={{ display: 'flex', gap: '10px' }}>
              <button
                style={{
                  background: '#10b981',
                  color: 'white',
                  border: 'none',
                  padding: '10px 20px',
                  borderRadius: '8px',
                  cursor: 'pointer',
                  display: 'flex',
                  alignItems: 'center',
                  gap: '8px',
                  fontSize: '14px'
                }}
              >
                <Download size={16} />
                Export Excel
              </button>
              <button
                style={{
                  background: '#ef4444',
                  color: 'white',
                  border: 'none',
                  padding: '10px 20px',
                  borderRadius: '8px',
                  cursor: 'pointer',
                  display: 'flex',
                  alignItems: 'center',
                  gap: '8px',
                  fontSize: '14px'
                }}
              >
                <Download size={16} />
                Export PDF
              </button>
            </div>
          </div>

          <div style={{ 
            display: 'grid', 
            gridTemplateColumns: 'repeat(auto-fill, minmax(350px, 1fr))', 
            gap: '20px' 
          }}>
            {participants.map((sgi, index) => {
              const colors = [
                { bg: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', light: '#e0e7ff', text: '#4338ca' },
                { bg: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)', light: '#fce7f3', text: '#be185d' },
                { bg: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)', light: '#dbeafe', text: '#0369a1' }
              ];
              const colorScheme = colors[index % colors.length];
              const presentsCount = sgi.participants.filter(p => p.statut_presence === 'present').length;

              return (
                <div 
                  key={index}
                  onClick={() => {
                    const sgiInfo = sgiList.find(s => s.sgi_id === sgi.sgi_id);
                    setSelectedSgi(sgiInfo);
                  }}
                  style={{
                    background: 'white',
                    border: `2px solid ${colorScheme.light}`,
                    borderRadius: '16px',
                    overflow: 'hidden',
                    cursor: 'pointer',
                    transition: 'all 0.3s ease'
                  }}
                  onMouseEnter={(e) => {
                    e.currentTarget.style.transform = 'translateY(-8px)';
                    e.currentTarget.style.boxShadow = `0 12px 24px ${colorScheme.light}`;
                  }}
                  onMouseLeave={(e) => {
                    e.currentTarget.style.transform = 'translateY(0)';
                    e.currentTarget.style.boxShadow = 'none';
                  }}
                >
                  <div style={{
                    background: colorScheme.bg,
                    padding: '25px',
                    position: 'relative'
                  }}>
                    <div style={{
                      background: 'rgba(255,255,255,0.3)',
                      backdropFilter: 'blur(10px)',
                      width: '60px',
                      height: '60px',
                      borderRadius: '15px',
                      display: 'flex',
                      alignItems: 'center',
                      justifyContent: 'center',
                      marginBottom: '15px'
                    }}>
                      <UserCheck size={30} color="white" />
                    </div>
                    <h4 style={{
                      fontSize: '18px',
                      fontWeight: '700',
                      color: 'white',
                      marginBottom: '8px'
                    }}>
                      {sgi.nom_sgi}
                    </h4>
                    <div style={{
                      color: 'rgba(255,255,255,0.9)',
                      fontSize: '13px'
                    }}>
                      {sgi.participants.length} participants inscrits
                    </div>
                  </div>

                  <div style={{ padding: '25px' }}>
                    <div style={{
                      display: 'grid',
                      gridTemplateColumns: '1fr 1fr',
                      gap: '15px',
                      marginBottom: '20px'
                    }}>
                      <div style={{
                        background: colorScheme.light,
                        padding: '15px',
                        borderRadius: '10px',
                        textAlign: 'center'
                      }}>
                        <div style={{ fontSize: '24px', fontWeight: 'bold', color: colorScheme.text }}>
                          {presentsCount}
                        </div>
                        <div style={{ fontSize: '12px', color: colorScheme.text, fontWeight: '500' }}>
                          Présents
                        </div>
                      </div>
                      <div style={{
                        background: '#f9fafb',
                        padding: '15px',
                        borderRadius: '10px',
                        textAlign: 'center'
                      }}>
                        <div style={{ fontSize: '24px', fontWeight: 'bold', color: '#6b7280' }}>
                          {sgi.participants.length - presentsCount}
                        </div>
                        <div style={{ fontSize: '12px', color: '#6b7280', fontWeight: '500' }}>
                          Absents
                        </div>
                      </div>
                    </div>

                    <div style={{
                      display: 'flex',
                      alignItems: 'center',
                      justifyContent: 'center',
                      gap: '8px',
                      color: colorScheme.text,
                      fontSize: '14px',
                      fontWeight: '600',
                      paddingTop: '15px',
                      borderTop: `1px solid ${colorScheme.light}`
                    }}>
                      <Eye size={16} />
                      Voir le détail
                    </div>
                  </div>
                </div>
              );
            })}
          </div>
        </div>
      );

      const renderActionnairesTab = () => (
        <div style={{ padding: '30px' }}>
          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '25px' }}>
            <h3 style={{ fontSize: '20px', color: '#1a202c' }}>
              Actionnaires par SGI
            </h3>
            <div style={{ display: 'flex', gap: '10px' }}>
              <button
                style={{
                  background: '#10b981',
                  color: 'white',
                  border: 'none',
                  padding: '10px 20px',
                  borderRadius: '8px',
                  cursor: 'pointer',
                  display: 'flex',
                  alignItems: 'center',
                  gap: '8px',
                  fontSize: '14px'
                }}
              >
                <Download size={16} />
                Export CSV
              </button>
              <button
                style={{
                  background: '#667eea',
                  color: 'white',
                  border: 'none',
                  padding: '10px 20px',
                  borderRadius: '8px',
                  cursor: 'pointer',
                  display: 'flex',
                  alignItems: 'center',
                  gap: '8px',
                  fontSize: '14px'
                }}
              >
                <Download size={16} />
                Export XLSX
              </button>
            </div>
          </div>

          <div style={{ 
            display: 'grid', 
            gridTemplateColumns: 'repeat(auto-fill, minmax(350px, 1fr))', 
            gap: '20px' 
          }}>
            {actionnaires.map((sgi, index) => {
              const colors = [
                { bg: 'linear-gradient(135deg, #10b981 0%, #059669 100%)', light: '#d1fae5', text: '#065f46' },
                { bg: 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)', light: '#fef3c7', text: '#92400e' },
                { bg: 'linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)', light: '#f3e8ff', text: '#6b21a8' }
              ];
              const colorScheme = colors[index % colors.length];

              return (
                <div 
                  key={index}
                  onClick={() => {
                    const sgiInfo = sgiList.find(s => s.sgi_id === sgi.sgi_id);
                    setSelectedSgi(sgiInfo);
                  }}
                  style={{
                    background: 'white',
                    border: `2px solid ${colorScheme.light}`,
                    borderRadius: '16px',
                    overflow: 'hidden',
                    cursor: 'pointer',
                    transition: 'all 0.3s ease'
                  }}
                  onMouseEnter={(e) => {
                    e.currentTarget.style.transform = 'translateY(-8px)';
                    e.currentTarget.style.boxShadow = `0 12px 24px ${colorScheme.light}`;
                  }}
                  onMouseLeave={(e) => {
                    e.currentTarget.style.transform = 'translateY(0)';
                    e.currentTarget.style.boxShadow = 'none';
                  }}
                >
                  <div style={{
                    background: colorScheme.bg,
                    padding: '25px',
                    position: 'relative'
                  }}>
                    <div style={{
                      background: 'rgba(255,255,255,0.3)',
                      backdropFilter: 'blur(10px)',
                      width: '60px',
                      height: '60px',
                      borderRadius: '15px',
                      display: 'flex',
                      alignItems: 'center',
                      justifyContent: 'center',
                      marginBottom: '15px'
                    }}>
                      <DollarSign size={30} color="white" />
                    </div>
                    <h4 style={{
                      fontSize: '18px',
                      fontWeight: '700',
                      color: 'white',
                      marginBottom: '8px'
                    }}>
                      {sgi.nom_sgi}
                    </h4>
                    <div style={{
                      color: 'rgba(255,255,255,0.9)',
                      fontSize: '13px'
                    }}>
                      {sgi.actionnaires.length} actionnaires
                    </div>
                  </div>

                  <div style={{ padding: '25px' }}>
                    <div style={{
                      display: 'grid',
                      gridTemplateColumns: '1fr 1fr',
                      gap: '15px',
                      marginBottom: '20px'
                    }}>
                      <div style={{
                        background: colorScheme.light,
                        padding: '15px',
                        borderRadius: '10px',
                        textAlign: 'center'
                      }}>
                        <div style={{ fontSize: '20px', fontWeight: 'bold', color: colorScheme.text }}>
                          {sgi.total_actions.toLocaleString()}
                        </div>
                        <div style={{ fontSize: '12px', color: colorScheme.text, fontWeight: '500' }}>
                          Actions
                        </div>
                      </div>
                      <div style={{
                        background: colorScheme.light,
                        padding: '15px',
                        borderRadius: '10px',
                        textAlign: 'center'
                      }}>
                        <div style={{ fontSize: '20px', fontWeight: 'bold', color: colorScheme.text }}>
                          {(sgi.total_valeur / 1000).toFixed(0)}K€
                        </div>
                        <div style={{ fontSize: '12px', color: colorScheme.text, fontWeight: '500' }}>
                          Valeur
                        </div>
                      </div>
                    </div>

                    <div style={{
                      display: 'flex',
                      alignItems: 'center',
                      justifyContent: 'center',
                      gap: '8px',
                      color: colorScheme.text,
                      fontSize: '14px',
                      fontWeight: '600',
                      paddingTop: '15px',
                      borderTop: `1px solid ${colorScheme.light}`
                    }}>
                      <Eye size={16} />
                      Voir le détail
                    </div>
                  </div>
                </div>
              );
            })}
          </div>
        </div>
      );

      const renderFichiersTab = () => (
        <div style={{ padding: '30px' }}>
          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '25px' }}>
            <h3 style={{ fontSize: '20px', color: '#1a202c' }}>
              Fichiers de l'AG ({fichiers.length})
            </h3>
            <button
              onClick={() => openModal('upload-file')}
              style={{
                background: '#667eea',
                color: 'white',
                border: 'none',
                padding: '12px 24px',
                borderRadius: '8px',
                cursor: 'pointer',
                display: 'flex',
                alignItems: 'center',
                gap: '8px',
                fontSize: '14px',
                fontWeight: '500'
              }}
            >
              <Upload size={18} />
              Upload Fichier
            </button>
          </div>

          {/* Barre de filtres */}
          <div style={{ 
            display: 'grid',
            gridTemplateColumns: '2fr 1fr',
            gap: '15px',
            marginBottom: '25px',
            alignItems: 'end'
          }}>
            <div style={{ position: 'relative' }}>
              <Search size={20} color="#9ca3af" style={{ 
                position: 'absolute', 
                left: '12px', 
                top: '50%', 
                transform: 'translateY(-50%)' 
              }} />
              <input
                type="text"
                placeholder="Rechercher un fichier..."
                value={searchTerm}
                onChange={(e) => setSearchTerm(e.target.value)}
                style={{
                  width: '100%',
                  padding: '12px 12px 12px 45px',
                  borderRadius: '8px',
                  border: '1px solid #e5e7eb',
                  fontSize: '14px',
                  outline: 'none'
                }}
              />
            </div>
            
            <select
              value={filterType}
              onChange={(e) => setFilterType(e.target.value)}
              style={{
                padding: '12px',
                borderRadius: '8px',
                border: '1px solid #e5e7eb',
                fontSize: '14px',
                outline: 'none'
              }}
            >
              <option value="all">Tous les types</option>
              <option value="liste_actionnaires">Listes actionnaires</option>
              <option value="rapport_presence">Rapports présence</option>
              <option value="proces_verbal">Procès-verbaux</option>
              <option value="convocation">Convocations</option>
            </select>
          </div>

          {/* Liste des fichiers */}
          <div style={{
            background: '#fafafa',
            borderRadius: '8px',
            overflow: 'hidden'
          }}>
            <div style={{
              display: 'grid',
              gridTemplateColumns: '3fr 1fr 1fr 1fr 1fr 2fr',
              gap: '15px',
              padding: '15px',
              background: '#f3f4f6',
              fontSize: '14px',
              fontWeight: '600',
              color: '#374151'
            }}>
              <div>Fichier</div>
              <div>Type</div>
              <div>Taille</div>
              <div>Statut</div>
              <div>Uploadé par</div>
              <div>Actions</div>
            </div>

            {fichiers
              .filter(file => {
                const matchesSearch = file.nom_fichier.toLowerCase().includes(searchTerm.toLowerCase());
                const matchesFilter = filterType === 'all' || file.type_fichier === filterType;
                return matchesSearch && matchesFilter;
              })
              .slice((currentPage - 1) * itemsPerPage, currentPage * itemsPerPage)
              .map(file => (
                <div key={file.fichier_id} style={{
                  display: 'grid',
                  gridTemplateColumns: '3fr 1fr 1fr 1fr 1fr 2fr',
                  gap: '15px',
                  padding: '15px',
                  borderBottom: '1px solid #e5e7eb',
                  alignItems: 'center',
                  fontSize: '14px',
                  background: 'white',
                  transition: 'background 0.3s ease'
                }}
                onMouseEnter={(e) => e.currentTarget.style.background = '#f9fafb'}
                onMouseLeave={(e) => e.currentTarget.style.background = 'white'}
                >
                  <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>
                    <FileText size={20} color="#667eea" />
                    <div>
                      <div style={{ fontWeight: '500', color: '#1a202c' }}>
                        {file.nom_fichier}
                      </div>
                      <div style={{ fontSize: '12px', color: '#6b7280' }}>
                        {new Date(file.date_upload).toLocaleDateString('fr-FR')}
                      </div>
                    </div>
                  </div>

                  <div style={{
                    background: '#e0e7ff',
                    color: '#4338ca',
                    padding: '4px 8px',
                    borderRadius: '12px',
                    fontSize: '11px',
                    fontWeight: '500',
                    textAlign: 'center'
                  }}>
                    {file.type_fichier}
                  </div>

                  <div style={{ color: '#6b7280' }}>
                    {file.taille}
                  </div>

                  <div style={{
                    background: file.statut === 'processed' ? '#d1fae5' : '#fef3c7',
                    color: file.statut === 'processed' ? '#065f46' : '#92400e',
                    padding: '4px 8px',
                    borderRadius: '12px',
                    fontSize: '11px',
                    fontWeight: '500',
                    textAlign: 'center'
                  }}>
                    {file.statut === 'processed' ? 'Traité' : 'En cours'}
                  </div>

                  <div style={{ color: '#6b7280', fontSize: '12px' }}>
                    {file.uploader_name}
                  </div>

                  <div style={{ display: 'flex', gap: '8px' }}>
                    <button
                      style={{
                        background: '#667eea',
                        color: 'white',
                        border: 'none',
                        padding: '6px 10px',
                        borderRadius: '6px',
                        cursor: 'pointer',
                        fontSize: '11px'
                      }}
                    >
                      <Eye size={12} />
                    </button>
                    <button
                      style={{
                        background: '#10b981',
                        color: 'white',
                        border: 'none',
                        padding: '6px 10px',
                        borderRadius: '6px',
                        cursor: 'pointer',
                        fontSize: '11px'
                      }}
                    >
                      <Download size={12} />
                    </button>
                    <button
                      style={{
                        background: '#ef4444',
                        color: 'white',
                        border: 'none',
                        padding: '6px 10px',
                        borderRadius: '6px',
                        cursor: 'pointer',
                        fontSize: '11px'
                      }}
                    >
                      <Trash2 size={12} />
                    </button>
                  </div>
                </div>
              ))}
          </div>
        </div>
      );

      return (
        <div style={{ padding: '40px' }}>
          <Breadcrumb />
          
          {/* Header AG */}
          <div style={{
            background: 'white',
            padding: '30px',
            borderRadius: '12px',
            boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
            marginBottom: '30px'
          }}>
            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>
              <div>
                <h2 style={{ fontSize: '28px', color: '#1a202c', marginBottom: '10px' }}>
                  {selectedAg.code_ag}
                </h2>
                <div style={{ display: 'flex', alignItems: 'center', gap: '20px' }}>
                  <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
                    <Building2 size={18} color="#667eea" />
                    <span style={{ fontSize: '16px', color: '#6b7280' }}>
                      {selectedAg.nom_entreprise}
                    </span>
                  </div>
                  <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
                    <Calendar size={18} color="#10b981" />
                    <span style={{ fontSize: '16px', color: '#6b7280' }}>
                      {new Date(selectedAg.date_ag).toLocaleDateString('fr-FR')}
                    </span>
                  </div>
                </div>
              </div>
            </div>

            <div style={{
              display: 'grid',
              gridTemplateColumns: 'repeat(4, 1fr)',
              gap: '20px'
            }}>
              <div style={{ background: '#f0f9ff', padding: '20px', borderRadius: '8px', textAlign: 'center' }}>
                <div style={{ fontSize: '24px', fontWeight: 'bold', color: '#1d4ed8' }}>
                  {participants.reduce((acc, sgi) => acc + sgi.participants.length, 0)}
                </div>
                <div style={{ fontSize: '14px', color: '#2563eb' }}>Total Participants</div>
              </div>
              <div style={{ background: '#f0fdf4', padding: '20px', borderRadius: '8px', textAlign: 'center' }}>
                <div style={{ fontSize: '24px', fontWeight: 'bold', color: '#166534' }}>
                  {participants.reduce((acc, sgi) => acc + sgi.participants.filter(p => p.statut_presence === 'present').length, 0)}
                </div>
                <div style={{ fontSize: '14px', color: '#16a34a' }}>Présents</div>
              </div>
              <div style={{ background: '#fef3c7', padding: '20px', borderRadius: '8px', textAlign: 'center' }}>
                <div style={{ fontSize: '24px', fontWeight: 'bold', color: '#d97706' }}>
                  {actionnaires.reduce((acc, sgi) => acc + sgi.total_actions, 0).toLocaleString()}
                </div>
                <div style={{ fontSize: '14px', color: '#f59e0b' }}>Actions Totales</div>
              </div>
              <div style={{ background: '#f9fafb', padding: '20px', borderRadius: '8px', textAlign: 'center' }}>
                <div style={{ fontSize: '24px', fontWeight: 'bold', color: '#374151' }}>
                  {fichiers.length}
                </div>
                <div style={{ fontSize: '14px', color: '#6b7280' }}>Fichiers</div>
              </div>
            </div>
          </div>

          {/* Tabs Navigation selon APIs */}
          <div style={{
            background: 'white',
            borderRadius: '12px',
            boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
            overflow: 'hidden'
          }}>
            <div style={{ display: 'flex', borderBottom: '1px solid #e5e7eb' }}>
              {[
                { 
                  id: 'participants', 
                  label: 'Participants', 
                  icon: UserCheck, 
                  count: participants.reduce((acc, sgi) => acc + sgi.participants.length, 0),
                  api: 'list_users_ag'
                },
                { 
                  id: 'actionnaires', 
                  label: 'Actionnaires', 
                  icon: DollarSign, 
                  count: actionnaires.reduce((acc, sgi) => acc + sgi.actionnaires.length, 0),
                  api: 'liste_actionnaires_ag'
                },
                { 
                  id: 'fichiers', 
                  label: 'Fichiers', 
                  icon: FolderOpen, 
                  count: fichiers.length,
                  api: 'get_list_file_ag'
                }
              ].map(tab => (
                <button
                  key={tab.id}
                  onClick={() => setAgActiveTab(tab.id)}
                  style={{
                    flex: 1,
                    padding: '20px',
                    background: agActiveTab === tab.id ? '#f9fafb' : 'transparent',
                    border: 'none',
                    cursor: 'pointer',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'center',
                    gap: '10px',
                    fontSize: '16px',
                    fontWeight: '500',
                    color: agActiveTab === tab.id ? '#667eea' : '#6b7280',
                    borderBottom: agActiveTab === tab.id ? '3px solid #667eea' : '3px solid transparent',
                    transition: 'all 0.3s ease'
                  }}
                >
                  <tab.icon size={20} />
                  {tab.label}
                  <div style={{
                    background: agActiveTab === tab.id ? '#667eea' : '#e5e7eb',
                    color: agActiveTab === tab.id ? 'white' : '#6b7280',
                    padding: '4px 10px',
                    borderRadius: '12px',
                    fontSize: '12px',
                    fontWeight: 'bold'
                  }}>
                    {tab.count}
                  </div>
                </button>
              ))}
            </div>

            {loading ? (
              <div style={{
                textAlign: 'center',
                padding: '60px',
                color: '#6b7280'
              }}>
                <div style={{
                  width: '50px',
                  height: '50px',
                  border: '4px solid #f3f4f6',
                  borderTop: '4px solid #667eea',
                  borderRadius: '50%',
                  margin: '0 auto 20px',
                  animation: 'spin 1s linear infinite'
                }}></div>
                Chargement des données...
              </div>
            ) : (
              <>
                {agActiveTab === 'participants' && renderParticipantsTab()}
                {agActiveTab === 'actionnaires' && renderActionnairesTab()}
                {agActiveTab === 'fichiers' && renderFichiersTab()}
              </>
            )}
          </div>
        </div>
      );
    }

    // Vue principale des AG (liste)
    return (
      <div style={{ padding: '40px' }}>
        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '30px' }}>
          <h2 style={{ fontSize: '28px', color: '#1a202c' }}>Assemblées Générales</h2>
          <button
            onClick={() => openModal('create-ag')}
            style={{
              background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
              color: 'white',
              border: 'none',
              padding: '12px 24px',
              borderRadius: '8px',
              cursor: 'pointer',
              display: 'flex',
              alignItems: 'center',
              gap: '8px',
              fontSize: '14px',
              fontWeight: '500',
              boxShadow: '0 4px 6px rgba(0,0,0,0.1)'
            }}
          >
            <Plus size={18} />
            Nouvelle AG
          </button>
        </div>

        <div style={{ 
          display: 'grid', 
          gridTemplateColumns: 'repeat(auto-fill, minmax(350px, 1fr))', 
          gap: '25px' 
        }}>
          {ags.map((ag) => (
            <div 
              key={ag.id} 
              onClick={() => loadAgData(ag)}
              style={{
                background: 'white',
                borderRadius: '12px',
                boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
                overflow: 'hidden',
                cursor: 'pointer',
                transition: 'all 0.3s ease'
              }}
              onMouseEnter={(e) => {
                e.currentTarget.style.transform = 'translateY(-5px)';
                e.currentTarget.style.boxShadow = '0 8px 20px rgba(0,0,0,0.15)';
              }}
              onMouseLeave={(e) => {
                e.currentTarget.style.transform = 'translateY(0)';
                e.currentTarget.style.boxShadow = '0 2px 8px rgba(0,0,0,0.1)';
              }}
            >
              <div style={{
                background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                padding: '25px',
                position: 'relative'
              }}>
                <div style={{
                  position: 'absolute',
                  top: '15px',
                  right: '15px',
                  background: 'rgba(255,255,255,0.2)',
                  padding: '6px 12px',
                  borderRadius: '20px',
                  fontSize: '12px',
                  color: 'white',
                  fontWeight: '500'
                }}>
                  {new Date(ag.date_ag).toLocaleDateString('fr-FR')}
                </div>
                <div style={{
                  background: 'white',
                  width: '60px',
                  height: '60px',
                  borderRadius: '12px',
                  display: 'flex',
                  alignItems: 'center',
                  justifyContent: 'center',
                  marginBottom: '15px'
                }}>
                  <Calendar size={30} color="#667eea" />
                </div>
                <h3 style={{
                  fontSize: '20px',
                  fontWeight: 'bold',
                  color: 'white',
                  marginBottom: '8px'
                }}>
                  {ag.code_ag}
                </h3>
                <div style={{
                  display: 'flex',
                  alignItems: 'center',
                  gap: '8px',
                  color: 'rgba(255,255,255,0.9)',
                  fontSize: '14px'
                }}>
                  <Building2 size={16} />
                  {ag.nom_entreprise}
                </div>
              </div>

              <div style={{ padding: '25px' }}>
                <div style={{
                  display: 'flex',
                  alignItems: 'center',
                  justifyContent: 'center',
                  gap: '8px',
                  color: '#667eea',
                  fontSize: '14px',
                  fontWeight: '600',
                  paddingTop: '10px',
                  borderTop: '1px solid #e5e7eb'
                }}>
                  <Eye size={16} />
                  Voir les participants, actionnaires et fichiers
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    );
  };

  // Modal simplifié
  const Modal = () => {
    if (!showModal) return null;

    return (
      <div style={{
        position: 'fixed',
        top: 0,
        left: 0,
        right: 0,
        bottom: 0,
        background: 'rgba(0,0,0,0.5)',
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
        zIndex: 1000
      }}
      onClick={() => setShowModal(false)}
      >
        <div 
          style={{
            background: 'white',
            borderRadius: '12px',
            padding: '30px',
            maxWidth: '500px',
            width: '90%',
            boxShadow: '0 20px 60px rgba(0,0,0,0.3)'
          }}
          onClick={(e) => e.stopPropagation()}
        >
          <h3 style={{ fontSize: '24px', marginBottom: '20px', color: '#1a202c' }}>
            {modalType === 'create-ag' ? 'Créer une AG' : 
             modalType === 'upload-file' ? 'Upload Fichier' : 'Modal'}
          </h3>
          
          <p style={{ color: '#6b7280' }}>
            Fonctionnalité à implémenter avec les vraies APIs
          </p>
          
          <button
            onClick={() => setShowModal(false)}
            style={{
              background: '#667eea',
              color: 'white',
              border: 'none',
              padding: '12px 24px',
              borderRadius: '8px',
              cursor: 'pointer',
              fontSize: '14px',
              fontWeight: '500',
              marginTop: '20px'
            }}
          >
            Fermer
          </button>
        </div>
      </div>
    );
  };

  // Autres vues simplifiées
  const EntreprisesView = () => <div style={{ padding: '40px' }}><h2>Entreprises - À implémenter avec API /liste_entreprises</h2></div>;
  const SGIView = () => <div style={{ padding: '40px' }}><h2>SGI - À implémenter avec API /liste_sgi</h2></div>;
  const RapportsView = () => <div style={{ padding: '40px' }}><h2>Rapports - À implémenter avec API /exports_listes</h2></div>;

  return (
    <div style={{ 
      minHeight: '100vh', 
      background: '#f3f4f6',
      fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'
    }}>
      <style jsx>{`
        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
      `}</style>
      
      <Navigation />
      <Breadcrumb />
      
      {currentView === 'dashboard' && <Dashboard />}
      {currentView === 'entreprises' && <EntreprisesView />}
      {currentView === 'ags' && <AGsView />}
      {currentView === 'sgi' && <SGIView />}
      {currentView === 'rapports' && <RapportsView />}
      
      <Modal />
    </div>
  );
};

export default App;
