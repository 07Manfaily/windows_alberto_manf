import React, { useState } from 'react';

const PieceComptable = () => {
  const [lignes, setLignes] = useState([
    { compte: '512001', libelle: 'Banque Crédit Agricole', debit: 15000, credit: 0 },
    { compte: '411001', libelle: 'Client Dupont SA', debit: 0, credit: 12000 },
    { compte: '701001', libelle: 'Ventes de marchandises', debit: 0, credit: 3000 }
  ]);

  const [nouvelleLigne, setNouvelleLigne] = useState({
    compte: '',
    libelle: '',
    debit: 0,
    credit: 0
  });

  const ajouterLigne = () => {
    if (nouvelleLigne.compte && nouvelleLigne.libelle) {
      setLignes([...lignes, { ...nouvelleLigne }]);
      setNouvelleLigne({ compte: '', libelle: '', debit: 0, credit: 0 });
    }
  };

  const supprimerLigne = (index) => {
    setLignes(lignes.filter((_, i) => i !== index));
  };

  const totalDebit = lignes.reduce((sum, ligne) => sum + Number(ligne.debit), 0);
  const totalCredit = lignes.reduce((sum, ligne) => sum + Number(ligne.credit), 0);

  const containerStyle = {
    maxWidth: '1200px',
    margin: '20px auto',
    padding: '20px',
    fontFamily: 'Arial, sans-serif',
    backgroundColor: '#f8f9fa',
    borderRadius: '8px',
    boxShadow: '0 2px 10px rgba(0,0,0,0.1)'
  };

  const headerStyle = {
    backgroundColor: '#2c3e50',
    color: 'white',
    padding: '20px',
    borderRadius: '8px 8px 0 0',
    marginBottom: '20px'
  };

  const titleStyle = {
    margin: '0 0 10px 0',
    fontSize: '24px',
    fontWeight: 'bold'
  };

  const infoRowStyle = {
    display: 'flex',
    justifyContent: 'space-between',
    fontSize: '14px'
  };

  const tableStyle = {
    width: '100%',
    borderCollapse: 'collapse',
    backgroundColor: 'white',
    borderRadius: '8px',
    overflow: 'hidden',
    boxShadow: '0 1px 3px rgba(0,0,0,0.1)'
  };

  const thStyle = {
    backgroundColor: '#34495e',
    color: 'white',
    padding: '12px',
    textAlign: 'left',
    fontWeight: 'bold',
    fontSize: '14px'
  };

  const tdStyle = {
    padding: '10px 12px',
    borderBottom: '1px solid #eee',
    fontSize: '13px'
  };

  const inputRowStyle = {
    backgroundColor: '#f1f2f6'
  };

  const inputStyle = {
    width: '100%',
    padding: '8px',
    border: '1px solid #ddd',
    borderRadius: '4px',
    fontSize: '13px'
  };

  const buttonStyle = {
    backgroundColor: '#27ae60',
    color: 'white',
    border: 'none',
    padding: '8px 15px',
    borderRadius: '4px',
    cursor: 'pointer',
    fontSize: '12px',
    fontWeight: 'bold'
  };

  const deleteButtonStyle = {
    backgroundColor: '#e74c3c',
    color: 'white',
    border: 'none',
    padding: '5px 10px',
    borderRadius: '3px',
    cursor: 'pointer',
    fontSize: '11px'
  };

  const totalRowStyle = {
    backgroundColor: '#2c3e50',
    color: 'white',
    fontWeight: 'bold'
  };

  const numberStyle = {
    textAlign: 'right'
  };

  const balanceStyle = {
    margin: '20px 0',
    padding: '15px',
    backgroundColor: totalDebit === totalCredit ? '#d4edda' : '#f8d7da',
    border: `1px solid ${totalDebit === totalCredit ? '#c3e6cb' : '#f5c6cb'}`,
    borderRadius: '5px',
    textAlign: 'center',
    fontWeight: 'bold',
    color: totalDebit === totalCredit ? '#155724' : '#721c24'
  };

  const formatNumber = (num) => {
    return new Intl.NumberFormat('fr-FR', {
      minimumFractionDigits: 2,
      maximumFractionDigits: 2
    }).format(num);
  };

  return (
    <div style={containerStyle}>
      <div style={headerStyle}>
        <h1 style={titleStyle}>PIÈCE COMPTABLE</h1>
        <div style={infoRowStyle}>
          <span>N° de pièce: PC-2024-001</span>
          <span>Date: {new Date().toLocaleDateString('fr-FR')}</span>
          <span>Journal: VTE</span>
        </div>
      </div>

      <table style={tableStyle}>
        <thead>
          <tr>
            <th style={thStyle}>N° Compte</th>
            <th style={thStyle}>Libellé</th>
            <th style={thStyle}>Débit (€)</th>
            <th style={thStyle}>Crédit (€)</th>
            <th style={thStyle}>Actions</th>
          </tr>
        </thead>
        <tbody>
          {lignes.map((ligne, index) => (
            <tr key={index}>
              <td style={tdStyle}>{ligne.compte}</td>
              <td style={tdStyle}>{ligne.libelle}</td>
              <td style={{...tdStyle, ...numberStyle}}>
                {ligne.debit > 0 ? formatNumber(ligne.debit) : '-'}
              </td>
              <td style={{...tdStyle, ...numberStyle}}>
                {ligne.credit > 0 ? formatNumber(ligne.credit) : '-'}
              </td>
              <td style={tdStyle}>
                <button 
                  style={deleteButtonStyle}
                  onClick={() => supprimerLigne(index)}
                >
                  Supprimer
                </button>
              </td>
            </tr>
          ))}
          
          <tr style={inputRowStyle}>
            <td style={tdStyle}>
              <input
                style={inputStyle}
                type="text"
                placeholder="N° compte"
                value={nouvelleLigne.compte}
                onChange={(e) => setNouvelleLigne({...nouvelleLigne, compte: e.target.value})}
              />
            </td>
            <td style={tdStyle}>
              <input
                style={inputStyle}
                type="text"
                placeholder="Libellé"
                value={nouvelleLigne.libelle}
                onChange={(e) => setNouvelleLigne({...nouvelleLigne, libelle: e.target.value})}
              />
            </td>
            <td style={tdStyle}>
              <input
                style={inputStyle}
                type="number"
                placeholder="Débit"
                value={nouvelleLigne.debit}
                onChange={(e) => setNouvelleLigne({...nouvelleLigne, debit: Number(e.target.value)})}
              />
            </td>
            <td style={tdStyle}>
              <input
                style={inputStyle}
                type="number"
                placeholder="Crédit"
                value={nouvelleLigne.credit}
                onChange={(e) => setNouvelleLigne({...nouvelleLigne, credit: Number(e.target.value)})}
              />
            </td>
            <td style={tdStyle}>
              <button style={buttonStyle} onClick={ajouterLigne}>
                Ajouter
              </button>
            </td>
          </tr>
          
          <tr style={totalRowStyle}>
            <td style={tdStyle} colSpan="2">TOTAUX</td>
            <td style={{...tdStyle, ...numberStyle}}>{formatNumber(totalDebit)}</td>
            <td style={{...tdStyle, ...numberStyle}}>{formatNumber(totalCredit)}</td>
            <td style={tdStyle}></td>
          </tr>
        </tbody>
      </table>

      <div style={balanceStyle}>
        {totalDebit === totalCredit ? 
          '✓ Équilibre respecté - Débit = Crédit' : 
          `⚠ Déséquilibre: ${formatNumber(Math.abs(totalDebit - totalCredit))}€`
        }
      </div>
    </div>
  );
};

export default PieceComptable;
